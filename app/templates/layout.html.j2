{%- macro display_timestamp(unix_timestamp) -%}
    {%- if now | int > unix_timestamp | int -%}
        {%- set seconds_timestamp   = now | int - unix_timestamp | int -%}
    {%- elif now | int < unix_timestamp | int -%}
        {%- set seconds_timestamp   = unix_timestamp | int - now | int -%}
    {%- else -%}
        now 
    {%- endif -%}
    {%- set delta   = seconds_timestamp | seconds2delta -%}
    {%- if now | int < unix_timestamp | int %}in {% endif -%}
    {{ display_delta(delta) }}
    {%- if now | int > unix_timestamp | int %} ago{%- endif -%}
{%- endmacro -%}
{%- macro display_delta(delta) -%}
    {%- if delta.days > 0 -%}
        {%- if delta.days > 30 -%}
            {%- set months                  = delta.days / 30 -%}
            {%- if months > 12 -%}
                {%- set years               = months / 12 -%}
                {%- if years > 10 -%}
                    {%- set decades         = years / 10 -%}
                    {%- set rounded_decades = decades | round | int -%}
                    {{ rounded_decades }} decade{% if rounded_decades != 1 %}s{% endif %}
                {%- else -%}
                    {%- set rounded_years   = years | round | int -%}
                    {{ rounded_years }} year{% if rounded_years != 1 %}s{% endif %}
                {%- endif -%}
            {%- else -%}
                {%- set rounded_months      = months | round | int -%}
                {{ rounded_months }} month{% if rounded_months != 1 %}s{% endif %}
            {%- endif -%}
        {%- else -%}
            {{ delta.days }} day{% if delta.days != 1 %}s{% endif %}
        {%- endif -%}
    {%- else -%}
        {%- set minutes = delta.seconds / 60 -%}
        {%- if minutes >= 60 -%}
            {%- set hours               = minutes / 60 -%}
            {%- set rounded_hours       = hours | round | int -%}
            {{ rounded_hours }} hour{% if rounded_hours != 1 %}s{% endif %}
        {%- else -%}
            {%- set rounded_minutes     = minutes | round | int -%}
            {{ rounded_minutes }} minute{% if rounded_minutes != 1 %}s{% endif %}
        {%- endif -%}
    {%- endif -%}
{%- endmacro -%}
<!DOCTYPE html>
<html lang="en">
    <head>
    {%- block head %}
        <meta charset="UTF-8">
        <meta name="author" content="Ishar MUD">
        <meta name="description" content="Ishar MUD">
        <meta name="keywords" content="Ishar MUD, Ishar, IsharMUD, MUD, Multi User Dungeon, Multi-User Dungeon, Game">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="Ishar MUD">
        <meta property="og:title" content="{% block meta_title %}Welcome{% endblock meta_title %} - Ishar MUD">
        <meta property="og:description" content="Ishar MUD: {% block meta_description %}a free online text-adventure RPG{% endblock %}">
        <meta property="og:url" content="{% block meta_url %}{{ url_for('welcome', _external=True) }}{% endblock meta_url %}">
        <meta property="og:image" content="{% block meta_image %}{{ url_for('static', filename='ishar.png', _external=True) }}{% endblock meta_image %}">
        <title>{% block title %}Welcome{% endblock %} - Ishar MUD</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
        <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    {%- endblock head %}
    {%- block scripts %}
    {%- endblock scripts %}
    </head>
    <body>
        <header>
            <h1 title="Ishar MUD">
                <a href="{{ url_for('welcome') }}">
                    <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Ishar MUD">
                </a>
            </h1>
        </header>
        <nav>
{%- block navigation %}
{% include('navigation.html.j2') %}
{%- endblock navigation %}
        </nav>
        <div id="content">
            <h2>
                {% block header %}{% endblock header %}
            </h2>
{%- with messages = get_flashed_messages(with_categories=True) %}
    {%- if messages %}
            <div id="flashes">
                <ul>
        {%- for category, message in messages %}
                    <li class="flash-{{ category }}">
                        {{ message }}
                    </li>
        {%- endfor %}
                </ul>
            </div>
    {%- endif %}
{%- endwith %}
{%- block content %}
{%- endblock content %}
        </div>
        <footer>
{%- block footer %}
    {%- if current_user is defined and current_user.is_authenticated %}
        {%- if current_user.created_at is defined and current_user.created_at != '' %}
            <span id="created" title="Account Created: {{ current_user.created_at.strftime('%A, %B %d, %Y %H:%M:%S') }}">
                <strong>Account Created</strong>
                <br>
                {{ current_user.created_at.strftime('%A, %B %d, %Y') }}
            </span>
        {%- endif %}
    {%- endif %}
    {%- if season is defined and season.season_id is defined and season.expiration_date is defined %}
        {%- set seconds_until_season_end    = season.expiration_date | int - now | int %}
        {%- set season_end_delta            = seconds_until_season_end | seconds2delta %}
        {%- set season_end                  = season.expiration_date | unix2datetime %}
            <span id="season" title="Season {{ season.season_id }} ends {{ display_timestamp(season.expiration_date) }}, on {{ season_end.strftime('%A, %B %d, %Y %H:%M:%S') }}">
                <strong>Season {{ season.season_id }}</strong>
                <br>
                ends {{ display_timestamp(season.expiration_date) }}, on {{ season_end.strftime('%A, %B %d, %Y') }}
            </span>
    {%- endif %}
{%- endblock footer %}
        </footer>
    </body>
</html>
