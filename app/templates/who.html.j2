{% extends "layout.html.j2" %}
{%- block meta_title -%}
Who's Online?
{%- if who is defined and who is iterable and who | length > 0 %} / {{ who | length }} player{%- if who | length != 1%}s{%- endif -%}
{%- endif -%}
{%- endblock meta_title -%}
{% block meta_description %}Who's Online on the MUD right now?{% endblock %}
{% block meta_url %}{{ url_for('who', _external=True) }}{% endblock meta_url %}">
{%- block title -%}
Who's Online?
{%- if who is defined and who is iterable and who | length > 0 %} / {{ who | length }} player{%- if who | length != 1%}s{%- endif -%}
{%- endif -%}
{%- endblock title -%}
{% block header %}Who's Online?{% endblock %}
{%- block content %}
    {%- if who is defined and who is iterable and who | length > 0 %}
                <h3 title="{{ who | length }} player{% if who | length != 1%}s{% endif %} online">
                    {{ who | length }} player{% if who | length != 1%}s{% endif %} online
                </h3>
                <table id="online">
                    <tr>
                        <th title="#">
                            #
                        </th>
                        <th title="Name">
                            Name
                        </th>
                        <th title="Level (Remorts)">
                            Level (Remorts)
                        </th>
                        <th title="Race">
                            Race
                        </th>
                        <th title="Class">
                            Class
                        </th>
                        <th title="Player">
                            Player
                        </th>
                    </tr>
        {%- for player in who %}
            {%- set player_title = player_title(player) %}
            {%- set player_type = player_type(player) %}
            {%- set player_css = player_css(player) %}
                    <tr>
                        <td id="{{ loop.index }}" title="#{{ loop.index }}">
                            {{ loop.index }}
                        </td>
                        <td title="{{ player_title | striptags }}">
                            {{ player_title }}
                        </td>
            {%- if player.true_level < immortal_level %}
                        <td title="Level: {{ player.level }} (Remorts: {{ player.remorts }})">
                            {{ player.level }} ({{ player.remorts }})
                        </td>
                        <td title="Race: {{ player.race.race_name | replace('_', '-') | title | safe }}">
                            {{ player.race.race_name | replace('_', '-') | title | safe }}
                        </td>
                        <td title="Class: {{ player.class.class_name | title | safe }}">
                            {{ player.class.class_name | title | safe }}
                        </td>
            {%- else %}
                        <td class="non-classic" colspan="3" title="Type: {{ player_type }}">
                            <span class="{{ player_css }}">
                                {{ player_type }}
                            </span>
                        </td>
            {%- endif %}
                        <td class="who-right" title="Player: {{ player.account.account_name | title | safe }}">
                            {{ player.account.account_name | title | safe }}
                        </td>
                    </tr>
        {%- endfor %}
                </table>
    {%- else %}
                <h3>
                    Unfortunately, nobody is online.
                </h3>
                <br>
    {%- endif %}
{% include('back.html.j2') %}
{%- endblock %}
