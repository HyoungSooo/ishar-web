{%- set page = 'account' -%}
{% extends "base/layout.html.j2" %}
{% block meta_title %}Account ({{ current_user.display_name | safe }}){% endblock meta_title %}
{% block meta_description %}Your Ishar MUD Account{% endblock meta_description %}
{% block meta_url %}{{ url_for('.account', _external=True) }}{% endblock meta_url %}
{% block title %}Account ({{ current_user.display_name | safe }}){% endblock title %}
{% block header %}Account ({{ current_user.display_name | safe }}){% endblock header %}
{%- block content %}
            <h4 title="Created">
                Created
            </h4>
            <ul id="account-details" title="Created: {{ current_user.created_at.strftime('%A, %B %d, %Y @ %H:%M:%S %Z') }} ({{ current_user.created }} ago)">
                <li>
                    {{ current_user.created_at.strftime('%A, %B %d, %Y @ %H:%M:%S %Z') }}
                </li>
                <li>
                    {{ current_user.created_ago }}
                </li>
            </ul>
            <h4 title="Manage">
                Manage
            </h4>
            <ul id="account-manage">
                <li title="Change your password">
                    <a href="{{ url_for('.change_password') }}">Change your password</a>
                </li>
                <li title="View your players">
                    <a href="{{ url_for('.player_portal') }}">View your players</a>
                </li>
            </ul>
    {%- if current_user.current_essence is defined and current_user.seasonal_earned is defined %}
            <h4 title="Essence">
                Essence
            </h4>
            <ul id="essence-balance">
                <li title="You currently have: {{ current_user.current_essence }} essence.">
                    You currently have:
                </li>
                <li class="nested-list">
                    <ul>
                        <li>
                            {{ display_essence(current_user.current_essence) }}
                        </li>
                    </ul>
                </li>
                <li title="This season, you have earned: {{ current_user.seasonal_earned }} essence.">
                    This season, you have earned:
                </li>
                <li class="nested-list">
                    <ul>
                        <li>
                            {{ display_essence(current_user.seasonal_earned) }}
                        </li>
                    </ul>
                </li>
            </ul>
    {%- endif %}
            <h4 title="Upgrades">
                Upgrades
            </h4>
            <ul id="essence-upgrades">
    {%- if current_user.upgrades is defined and current_user.upgrades is iterable and current_user.upgrades | selectattr('amount', '>', 0) | list | length > 0 %}
        {%- for upgraded in current_user.upgrades | selectattr('amount', '>', 0) %}
                <li title="{{ upgraded.upgrade.name }}{% if upgraded.amount > 1 %} (x{{ upgraded.amount}}){% endif %}">
                    {{ upgraded.upgrade.name }}
                    {%- if upgraded.amount > 1 %} (x{{ upgraded.amount}}){% endif %}
                </li>
        {%- endfor %}
    {%- else %}
                <li title="You have not purchased any upgrades.">
                    <i>You have not purchased any upgrades.</i>
                </li>
    {%- endif %}
            </ul>
{%- endblock content %}
