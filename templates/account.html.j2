{% extends "layout.html.j2" %}
{% block meta_title %}Account ({{ current_user.account_name | title | safe }}){% endblock meta_title %}
{% block meta_description %}View information about, and manage your, Ishar MUD{% endblock%}
{% block meta_url %}{{ url_for('account', _external=True) }}{% endblock meta_url %}">
{% block title %}Account ({{ current_user.account_name | title | safe }}){% endblock %}
{% block header %}Account ({{ current_user.account_name | title | safe }}){% endblock %}
{%- block content %}
            <p>
                <strong>
                    Welcome to your account page!
                </strong>
            </p>
            <p>
                You can view information about, <i>and eventually manage,</i> your Ishar MUD account.
            </p>
            <div id="account-details">
                <ul>
                    <li title="You created your account on {{ current_user.created_at.strftime('%A, %B %d, %Y @ %H:%M:%S %Z') }}">
                        You created your account on {{ current_user.created_at.strftime('%A, %B %d, %Y @ %H:%M:%S %Z') }}.
                    </li>
                </ul>
            </div>
            <h4 title="Upgrades">
                Upgrades
            </h4>
    {%- if current_user.upgrades is defined and current_user.upgrades is iterable and current_user.upgrades | selectattr('amount', '>', 0) | list | length > 0 %}
            <div id="essence-upgrades">
                <ul>
        {%- for upgraded in current_user.upgrades | selectattr('amount', '>', 0) %}
                    <li title="{{ upgraded.upgrade.name }}{% if upgraded.amount > 1 %} (x{{ upgraded.amount}}){% endif %}">
                        {{ upgraded.upgrade.name }}
                        {%- if upgraded.amount > 1 %} (x{{ upgraded.amount}}){% endif %}
                    </li>
        {%- endfor %}
                </ul>
            </div>
    {%- else %}
            <ul>
                <li title="You have not purchased any upgrades.">
                    <i>You have not purchased any upgrades.</i>
                </li>
            </ul>
    {%- endif %}
            <h4>
                Essence
            </h4>
            <p>
                "Essence" are the rewards points earned for your account during the season!
            </p>
            <p>
                Essence is preserved across seasons, and can be spent at any time
                <a href="{{ url_for('shop') }} ">at the Shop</a>
                or by typing <code>shop</code> in-game, once logged in.
            </p>
        {%- if current_user is defined and current_user.seasonal_points is defined and current_user.seasonal_earned is defined %}
            <div id="essence-balance">
                <ul>
                    <li title="You currently have: {{ current_user.seasonal_points }} essence.">
                        You currently have: {{ display_essence(current_user.seasonal_points) }}.
                    </li>
                    <li title="This season, you have earned: {{ current_user.seasonal_earned }} essence.">
                        This season, you have earned: {{ display_essence(current_user.seasonal_earned) }}.
                    </li>
                </ul>
            </div>
        {%- endif %}
{% include('back.html.j2') %}
{%- endblock %}
