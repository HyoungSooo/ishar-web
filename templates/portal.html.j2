{%- set page = 'portal' -%}
{% extends "layout.html.j2" %}
{% block meta_title %}Portal{% endblock meta_title %}
{% block meta_description %}Portal for players to see information about their account and characters{% endblock %}
{% block meta_url %}{{ url_for('portal', _external=True) }}{% endblock meta_url %}">
{% block title %}Portal{% endblock %}
{% block header %}Welcome{% if current_user.account_name is defined %}, {{ current_user.account_name | title | safe }}{% endif %}!{% endblock %}
{%- block content %}
    {%- if current_user.players is defined and current_user.players is iterable and current_user.players | length > 0 %}
                <h3 title="You have {{ current_user.players | length }} character{% if current_user.players | length != 1 %}s{% endif %}">
                    You have {{ current_user.players | length }} character{% if current_user.players | length != 1 %}s{% endif %}:
                </h3>
                <table id="players">
                    <tr>
                        <th>
                            Name
                        </th>
                        <th>
                            Level
                        </th>
                        <th>
                            Class
                        </th>
                        <th>
                            Remorts
                        </th>
                        <th>
                            Renown
                        </th>
                        <th>
                            Quests
                        </th>
                        <th>
                            Challenges
                        </th>
                        <th>
                            Deaths
                        </th>
                    </tr>
        {%- for player in current_user.players %}
                    <tr>
                        <td title="{{ player.name }} (Born {{ player.birth_dt.strftime('%A, %B %d, %Y @ %H:%M:%S %Z') }})">
                            {{ player.player_link }}
                        </td>
                        <td title="Level: {{ player.level }}">
                            {{ player.level }}
                        </td>
                        <td title="Class: {{ player.class.class_name }}">
                            {{ player.class.class_name | title }}
                        </td>
                        <td title="Remorts: {{ player.remorts }}">
                            {{ player.remorts }}
                        </td>
                        <td title="Renown: {{ player.total_renown }}">
                            {{ player.total_renown }}
                        </td>
                        <td title="Quests: {{ player.quests_completed }}">
                            {{ player.quests_completed }}
                        </td>
                        <td title="Challenges: {{ player.challenges_completed }}">
                            {{ player.challenges_completed }}
                        </td>
            {%- if player.player_type != 'Classic' %}
                        <td class="non-classic" title="Type: {{ player.player_type }}">
                            <span class="{{ player.player_css }}">
                                {{ player.player_type }}
                            </span>
            {%- else %}
                        <td title="Deaths: {{ player.deaths }}">
                            {{ player.deaths }}
            {%- endif %}
                        </td>
                    </tr>
        {%- endfor %}
                </table>
    {%- else %}
                <h3 title="You have not created any players yet!">
                    You have not created any players yet!
                </h3>
    {%- endif %}
{%- endblock %}
