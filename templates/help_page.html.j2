{%- set page = 'help' -%}
{% extends "base/layout.html.j2" %}
{%- if topic is defined and topic is iterable and topic['name'] is defined %}
    {%- set topic_name = topic['name'] | safe | trim %}
{%- endif %}
{%- block meta_title -%}Help{%- if topic_name -%}: {{ topic_name }}{%- endif -%}{%- endblock meta_title -%}
{%- block meta_description %}Help pages for Ishar MUD{%- endblock meta_description %}
{%- block meta_url %}{{ url_for('help_page.single', topic=topic_name, _external=True) }}{%- endblock meta_url %}
{%- block header -%}
<a href="{{ url_for('help_page.index') }}">Help</a>
    {%- if topic_name %} : <a href="{{ url_for('help_page.single', topic=topic_name) }}">
        {{- topic_name }}</a>
    {%- endif -%}
{%- endblock header -%}
{%- block title %}Help{% if topic_name %}: {{ topic_name }}{% endif %}{% endblock title -%}
{%- macro render_field(field) -%}
                    {{ field(**kwargs) | safe }}
    {%- if field.errors %}
                <ul class="field-errors">
        {%- for error in field.errors %}
                    <li>
                        {{ error }}
                    </li>
        {%- endfor %}
                </ul>
    {%- endif %}
{%- endmacro -%}
{%- block content %}
    {%- if current_user.is_anonymous %}
            <p>
                If you are new here, you may want to download one of many
                <a href="{{ url_for('mud_clients.index') }}" title="MUD clients">MUD clients</a>,
                and see our <a href="{{ url_for('welcome.getstarted') }}" title="getting started guide">getting started guide</a>.
            </p>
    {%- endif %}
    {%- if help_search_form is defined %}
            <div>
                <form method="get" action="{{ url_for('help_page.index') }}" id="help-search-form">
                    {{ render_field(help_search_form.search, maxlength=32) }}
                    <input type="submit" value="Search">
                    (<i>such as &quot;<a href="{{ url_for('help_page.single', topic='spell') }}">spell</a>&quot; or
                    &quot;<a href="{{ url_for('help_page.single', topic='MUD Basics') }}">MUD Basics</a>&quot;</i>)
                </form>
            </div>
    {%- endif %}
    {%- if topic %}
            <br><hr>
            <ul class="help-topic-list">
        {%- for i in ['syntax', 'level', 'minimum', 'class', 'topic', 'save', 'stats'] %}
            {%- if topic[i] %}
                <li>
                    <strong>{{ i | title }}</strong>:
                    <code>{{ topic[i] }}</code>
                </li>
            {%- endif %}
        {%- endfor %}
            </ul>
            <div>
                <pre>{{ topic['body_html'] | safe }}</pre>
            </div>
    {%- endif %}
    {%- if topics and topics is iterable and topics | length > 0 %}
            <hr>
            <ul class="help-topic-list">
        {%- for list_topic in topics %}
                <li title="Topic: {{ list_topic }}">
                    <a href="{{ url_for('help_page.single', topic=list_topic) }}">{{ list_topic }}</a>
                </li>
        {%- endfor %}
            </ul>
    {%- endif %}
{%- endblock content %}
