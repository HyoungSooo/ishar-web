{%- set page = 'help' -%}
{% extends "layout.html.j2" %}
{%- if topic is defined and topic is iterable and topic['name'] is defined %}
    {%- set topic_name = topic['name'] | safe | trim %}
{%- endif %}
{%- block meta_title -%}Help{%- if topic_name -%}: {{ topic_name }}{%- endif -%}{%- endblock meta_title -%}
{%- block meta_description %}Help pages for Ishar MUD{%- endblock meta_description %}
{%- block meta_url %}{{ url_for('help_page.single', topic=topic_name, _external=True) }}{%- endblock meta_url %}
{%- block header -%}
<a href="{{ url_for('help_page.index') }}">Help</a>
    {%- if topic_name %} : <a href="{{ url_for('help_page.single', topic=topic_name) }}">
        {{- topic_name }}</a>
    {%- endif -%}
{%- endblock header -%}
{%- block title %}Help{% if topic_name %}: {{ topic_name }}{% endif %}{% endblock title -%}
{%- macro render_field(field) -%}
                    {{ field(**kwargs) | safe }}
    {%- if field.errors %}
                <ul class="field-errors">
        {%- for error in field.errors %}
                    <li>
                        {{ error }}
                    </li>
        {%- endfor %}
                </ul>
    {%- endif %}
{%- endmacro -%}
{%- block content %}
    {%- if current_user.is_anonymous %}
            <p>
                If you are new here, you may want to download one of many
                <a href="{{ url_for('mud_clients.index') }}" title="MUD clients">MUD clients</a>,
                and see our <a href="{{ url_for('get_started.index') }}" title="getting started guide">getting started guide</a>.
            </p>
    {%- endif %}
    {%- if help_search_form is defined %}
            <div>
                <form method="get" action="{{ url_for('help_page.index') }}" id="help-search-form">
                    {{ render_field(help_search_form.search, maxlength=32) }}
                    <input type="submit" value="Search">
                    (<i>such as &quot;<a href="{{ url_for('help_page.single', topic='spell') }}">spell</a>&quot; or
                    &quot;<a href="{{ url_for('help_page.single', topic='MUD Basics') }}">MUD Basics</a>&quot;</i>)
                </form>
            </div>
    {%- endif %}
    {%- if topic %}
            <ul>
        {%- for i in ['syntax', 'level', 'minimum', 'class', 'topic', 'save'] %}
            {%- if topic[i] %}
                <li class="nested-list">
                    <li>
                        <strong>{{ i | title }}</strong>
                    </li>
                    <li class="nested-list">
                        <ul>
                            <li>
                                <code>{{ topic[i] | safe }}</code>
                            </li>
                        </ul>
                    </li>
                </li>
            {%- endif %}
        {%- endfor %}
            </ul>
            <pre>{{ topic['body_text'] | safe }}</pre>
            {%- if topic['aliases'] and topic['aliases'] is iterable and topic['aliases'] | length > 0 %}
            <ul>
                <li class="nested-list">
                    <i>Aliases:</i>
                </li>
                <li class="nested-list">
                    <ul>
                {%- for topic_alias in topic['aliases'] %}
                        <li>
                            <a href="{{ url_for('help_page.single', topic=topic_alias) }}">{{ topic_alias }}</a>
                        </li>
                {%- endfor %}
                    </ul>
                </li>
            </ul>
            {%- endif %}
            {%- if topic['see_also'] and topic['see_also'] is iterable and topic['see_also'] | length > 0 %}
            <ul>
                <li class="nested-list">
                    <i>See Also:</i>
                </li>
                <li class="nested-list">
                    <ul>
                {%- for related_topic in topic['see_also'] %}
                        <li>
                            <a href="{{ url_for('help_page.single', topic=related_topic) }}">{{ related_topic }}</a>
                        </li>
                {%- endfor %}
                    </ul>
                </li>
            </ul>
            {%- endif %}
            <br><hr><br>
    {%- endif %}
    {%- if topics and topics is iterable and topics | length > 0 %}
            <ul id="help-topic-list">
        {%- for list_topic in topics %}
                <li title="Topic: {{ list_topic }}">
                    <a href="{{ url_for('help_page.single', topic=list_topic) }}">{{ list_topic }}</a>
                </li>
        {%- endfor %}
            </ul>
    {%- endif %}
{%- endblock content %}
